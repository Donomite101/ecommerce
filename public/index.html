<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZeroLayer - Shop Clothing</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="bg-gray-50">
  <!-- Navbar -->
  <nav class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <a href="/" class="text-2xl font-bold text-indigo-600">ZeroLayer</a>
      <div class="space-x-6">
        <a href="/cart.html" class="text-gray-700 hover:text-indigo-600 font-medium">Cart</a>
        <a href="/orders.html" class="text-gray-700 hover:text-indigo-600 font-medium">Orders</a>
        <a href="/login.html" id="login-link" class="text-gray-700 hover:text-indigo-600 font-medium">Login</a>
        <a href="/signup.html" id="signup-link" class="text-gray-700 hover:text-indigo-600 font-medium">Signup</a>
        <button id="logout-button" onclick="logout()" class="text-red-500 font-medium hidden">Logout</button>
      </div>
    </div>
  </nav>

  <!-- Hero Banner -->
  <div class="bg-gradient-to-r from-indigo-600 to-purple-500 text-white text-center py-16">
    <h1 class="text-4xl font-bold mb-2">Mega Summer Sale is Live!</h1>
    <p class="text-lg">Enjoy up to 50% off on Men's, Women's, and Kids' Fashion</p>
    <a href="#men" class="mt-6 inline-block bg-white text-indigo-600 font-semibold px-6 py-3 rounded shadow hover:bg-gray-100">Shop Now</a>
  </div>

  <!-- Offers Section -->
  <div class="bg-white py-8 shadow">
    <div class="max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-3 gap-6 text-center">
      <div>
        <h3 class="text-xl font-bold text-indigo-600">Free Shipping</h3>
        <p class="text-gray-600">On orders above ₹1500</p>
      </div>
      <div>
        <h3 class="text-xl font-bold text-indigo-600">24/7 Support</h3>
        <p class="text-gray-600">We're here to help you anytime</p>
      </div>
      <div>
        <h3 class="text-xl font-bold text-indigo-600">Easy Returns</h3>
        <p class="text-gray-600">Hassle-free 10-day returns</p>
      </div>
    </div>
  </div>

  <!-- Product Sections -->
  <div class="max-w-6xl mx-auto px-4 py-12">
    <h2 id="men" class="text-3xl font-bold mb-6 text-gray-800">Men's Clothing</h2>
    <div id="men-products" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mb-12"></div>

    <h2 id="women" class="text-3xl font-bold mb-6 text-gray-800">Women's Clothing</h2>
    <div id="women-products" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mb-12"></div>

    <h2 id="kids" class="text-3xl font-bold mb-6 text-gray-800">Kids' Clothing</h2>
    <div id="kids-products" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8"></div>
  </div>

  <!-- Footer -->
  <footer class="bg-white border-t mt-12">
    <div class="max-w-6xl mx-auto px-4 py-6 flex flex-col md:flex-row justify-between items-center text-sm text-gray-500">
      <p>&copy; 2025 ZeroLayer. All rights reserved.</p>
      <div class="space-x-4">
        <a href="#" class="hover:text-indigo-600">Privacy</a>
        <a href="#" class="hover:text-indigo-600">Terms</a>
        <a href="#" class="hover:text-indigo-600">Contact</a>
      </div>
    </div>
  </footer>

  <script src="/js/logout.js"></script>
  <script>
    function updateNav() {
      const token = localStorage.getItem('token');
      document.getElementById('login-link').style.display = token ? 'none' : 'inline';
      document.getElementById('signup-link').style.display = token ? 'none' : 'inline';
      document.getElementById('logout-button').style.display = token ? 'inline' : 'none';
    }

    async function fetchProducts() {
      try {
        const response = await fetch('/api/products');
        const products = await response.json();

        const menDiv = document.getElementById('men-products');
        const womenDiv = document.getElementById('women-products');
        const kidsDiv = document.getElementById('kids-products');

        menDiv.innerHTML = '';
        womenDiv.innerHTML = '';
        kidsDiv.innerHTML = '';

        products.forEach(p => {
          const card = `
            <div class="bg-white shadow rounded-lg p-4">
              <img src="${p.image}" alt="${p.name}" class="w-full h-48 object-cover rounded">
              <h3 class="mt-2 font-semibold text-lg text-gray-800">${p.name}</h3>
              <p class="text-indigo-600 font-bold mt-1 mb-3">₹${p.price.toFixed(2)}</p>
              <button onclick="addToCart('${p._id}')" class="w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700">Add to Cart</button>
            </div>
          `;
          if (p.category.toLowerCase() === 'men') menDiv.innerHTML += card;
          else if (p.category.toLowerCase() === 'women') womenDiv.innerHTML += card;
          else if (p.category.toLowerCase() === 'kids') kidsDiv.innerHTML += card;
        });
      } catch (err) {
        console.error('Failed to load products:', err);
      }
    }

    async function addToCart(productId) {
      const token = localStorage.getItem('token');
      if (!token) return window.location.href = '/login.html';

      try {
        await fetch('/api/cart/add', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ productId, quantity: 1 })
        });
        alert('Item added to cart!');
      } catch (err) {
        console.error('Add to cart failed:', err);
        alert('Error adding item to cart.');
      }
    }

    updateNav();
    fetchProducts();
  </script>
</body>
</html>
